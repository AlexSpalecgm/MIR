#!/bin/bash

# Адрес VictoriaMetrics
VM_URL="http://<ваш_сервер>:8428"
# Файл со списком метрик
METRICS_FILE="metrics.txt"

while read -r metric; do
    echo "Метрика: $metric"
    # Получаем список всех меток для этой конкретной метрики
    labels_json=$(curl -s "$VM_URL/api/v1/labels" --data-urlencode "match[]={$metric}")
    # Извлекаем имена меток из JSON
    labels=$(echo "$labels_json" | jq -r '.data[]')
    echo "Уникальные метки:"
    for label in $labels; do
        echo "  $label"
    done
    echo ""
done < "$METRICS_FILE"
